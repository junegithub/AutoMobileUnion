<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>CvNetVideo_js_1.3.0控件测试</title>
    <script type="text/javascript" src="https://lib.cvtsp.com/video/CVNetVideoJs/1.3.0/CvNetVideo.js"></script>
	<script type="text/javascript" src="./uni.webview.1.5.4.js"></script>
</head>

<body>
	
	<div class="btn-list">
		<button class="btn btn-red" type="button" id="postMessage">postMessage</button>
	</div>
	
<div id="player" style="width:700px;height:982px;background:rgb(0, 0, 0);">
    <script>

        window.onload = function () {
            //ijk.log(CvNetVideo.version);
            init();
			window.resultList = (data)=>{  
			        // alert(data)  
			        console.log("webview内部："+data)  
			        console.log(data.length)  
			       // window.postData(data)  
			
			    };

        };
        function onHlsPlay(id, ucVideo, hlshttp, hlshttps, rtmpurl, cid) {
           // ijk.play(rtmpurl);
		   // alert("urnl:"+rtmpurl)
            console.log(hlshttp, hlshttps, rtmpurl, cid);
		uni.postMessage({
						data: {
							action: rtmpurl
						}
					});
			return  true;
        }
        var uc1;
        function init() {
            uc1 = CvNetVideo.Init(document.querySelector("#player"), 1,
                {
                networkSpeaking:false,
                    //事件通知
                    events: {
                        //HLS模式播放前通知 可获取RTMP HLS 等URL
                        onHlsPlay: onHlsPlay
                    }
                });
        }
		function QueryVideoFileListCallback(data){
			// alert('----videoCallBack')
			// alert(data)
			// alert(Object.keys(data))
		uni.postMessage({
						data:JSON.stringify(data)
					});
			// alert(data.FileList)
			console.log(data)
			
		}
		
		//实时流
		function Connectt(sim,channel=1,startTime,endTime,Alarm=0,MediaType=0,StreamType=0,StorageType=1,server,port) {
					// console.log("dfdffd");
					// alert(sim)
				let newSim = sim.toString().padStart(12,0)
					CvNetVideo.QueryVideoFileList(
						newSim,
						// parseInt(document.querySelector('#cmbChannel').value),//通道号
						channel,
						startTime,
						endTime,
						// document.querySelector('#numAlarm').value,//报警标志
						Alarm,
						// parseInt(document.querySelector('#cmbMideaType').value),//媒体类型
						MediaType,
						// parseInt(document.querySelector('#cmbStreamType_back').value),//码流类型
						StreamType,
						// parseInt(document.querySelector('#cmbStorageType').value),//存储器类型
						StorageType,
						QueryVideoFileListCallback,
						0,
						{
								clusterHost: server,
								clusterPort: port
						},
						// parseInt(document.querySelector('#cmbDataSource').value)//来源
						0
					)
				
		 }
		 //实时流
		 function Connect(sim,channel,streamType,mideaType,server,port,protocol) {
		 			console.log("dfdffd");
		 		alert('1112')
		     //  CvNetVideo.StartRealTimeVideo(
		 			 //    sim,
		     //      channel,
		     //      streamType,
		     //      mideaType,
		     //      0,
		     //      {
		     //          clusterHost: server,
		     //          clusterPort: port,
		     //          protocol: protocol
		     //      },
		     //      null,
		 				// 6);
		  }
        //实时流
       function Connect(sim,channel,startTime,endTime,streamType,mideaType=0,server,port,protocol) {
			console.log("dfdffd");
			alert('1111')
		// 	CvNetVideo.QueryVideoFileList(
		// 		sim,
		// 		// parseInt(document.querySelector('#cmbChannel').value),//通道号
		// 		channel,
		// 		startTime,
		// 		endTime,
		// 		// document.querySelector('#numAlarm').value,//报警标志
		// 		'0',
		// 		// parseInt(document.querySelector('#cmbMideaType').value),//媒体类型
		// 		mideaType,
		// 		// parseInt(document.querySelector('#cmbStreamType_back').value),//码流类型
		// 		'0',
		// 		// parseInt(document.querySelector('#cmbStorageType').value),//存储器类型
		// 		'1',
		// 		QueryVideoFileListCallback,
		// 		0,
		// 		{
		// 				clusterHost: server,
		// 				clusterPort: port
		// 		},
		// 		// parseInt(document.querySelector('#cmbDataSource').value)//来源
		// 		0
		// 	)
		


        }

    </script>
</div>
</body>
</html>
